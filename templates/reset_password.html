{% extends "base.html" %}

{% block title %}Reset Password - Ham Radio Olympics{% endblock %}

{% block content %}
<h2>Reset Password</h2>

<div class="card" style="max-width: 400px;">
    {% if error %}
    <div class="alert alert-error">{{ error }}</div>
    {% elif success %}
    <div class="alert alert-success">{{ success }}</div>
    <p><a href="/login">Go to Login</a></p>
    {% else %}
    <p>Enter your new password for <strong>{{ callsign }}</strong>.</p>
    <form method="POST" id="reset-form" data-loading>
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <div class="form-group">
            <label for="password">New Password</label>
            <input type="password" id="password" name="password" required minlength="8">
        </div>
        <div class="form-group">
            <label for="confirm_password">Confirm Password</label>
            <input type="password" id="confirm_password" name="confirm_password" required minlength="8">
        </div>
        <button type="submit" class="btn btn-success"><span class="icon">ðŸ”’</span> Reset Password</button>
    </form>
    <div id="reset-result"></div>
    {% endif %}
    <p style="margin-top: 15px;"><a href="/login">Back to Login</a></p>
</div>

<script>
document.getElementById('reset-form')?.addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    const confirm = document.getElementById('confirm_password').value;

    if (password !== confirm) {
        e.preventDefault();
        document.getElementById('reset-result').innerHTML =
            '<div class="alert alert-error">Passwords do not match.</div>';
    }
});
</script>
{% endblock %}
